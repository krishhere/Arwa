@using System.Data
@model System.Data.DataTable

@if (Model != null && Model.Rows.Count > 0)
{
    <table id="myDataTable_no_filter" class="table align-middle table-hover nowrap dataTable no-footer dtr-inline">
        <thead>
            <tr class="small text-muted text-uppercase">
                <th><span style="padding-right:20px;">Prod. Manager</span></th>
                <th><span style="padding-right:20px;">Vendor Name</span></th>
                <th><span style="padding-right:20px;">Vendor Location</span></th>
                <th><span style="padding-right:20px;">Vendor Phone</span></th>
                <th><span style="padding-right:20px;">0.25L</span></th>
                <th><span style="padding-right:20px;">0.5L</span></th>
                <th><span style="padding-right:20px;">1L</span></th>
                <th><span style="padding-right:20px;">2L</span></th>
                <th><span style="padding-right:20px;">5L</span></th>
                <th><span style="padding-right:20px;">20L</span></th>
                <th><span style="padding-right:20px;">Amount Quoted</span></th>
                <th><span style="padding-right:20px;">Amount Paid</span></th>
                <th><span style="padding-right:20px;">Amount Pending</span></th>
                <th><span style="padding-right:20px;">Billing Time</span></th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (DataRow row in Model.Rows)
            {
                <tr>
                    <td>@row["Prod. Manager"]</td>
                    <td>@row["Vendor Name"]</td>
                    <td>@row["Vendor Location"]</td>
                    <td>@row["Vendor Phone"]</td>
                    <td>@row["0.25L"]</td>
                    <td>@row["0.5L"]</td>
                    <td>@row["1L"]</td>
                    <td>@row["2L"]</td>
                    <td>@row["5L"]</td>
                    <td>@row["20L"]</td>
                    <td>@row["Amount Billed"]</td>
                    <td>@row["Amount Paid"]</td>
                    <td>@row["Debt"]</td>
                    <td>@row["BillingTime"]</td>
                    <td>
                        <button type="button" class="btn btn-link btn-sm text-muted" data-bs-toggle="tooltip"
                            data-bs-placement="top" title="Download invoice">
                            <i class="fa fa-download"></i>
                        </button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <table class="table">
        @{
            decimal totalBilled = Model.Rows.Cast<DataRow>()
            .Sum(row =>
            {
                if (row["Amount Billed"] != DBNull.Value && decimal.TryParse(row["Amount Billed"].ToString(), out decimal val))
                {
                    return val;
                }
                return 0m;
            });

            decimal totalPaid = Model.Rows.Cast<DataRow>()
            .Sum(row =>
            {
                if (row["Amount Paid"] != DBNull.Value && decimal.TryParse(row["Amount Paid"].ToString(), out decimal val))
                {
                    return val;
                }
                return 0m;
            });

            decimal totalDebt = Model.Rows.Cast<DataRow>()
            .Sum(row =>
            {
                if (row["Debt"] != DBNull.Value && decimal.TryParse(row["Debt"].ToString(), out decimal val))
                {
                    return val;
                }
                return 0m;
            });
        }
        <tr class="table-secondary fw-bold">
            <td>Total Quoted Amount: <span class="text-success">₹ @totalBilled.ToString("N2")</span></td>
            <td>Total Paid Amount: <span class="text-primary">₹ @totalPaid.ToString("N2")</span></td>
            <td>Total Pending Amount: <span class="text-danger">₹ @totalDebt.ToString("N2")</span></td>
        </tr>
    </table>
}
else
{
    <div class="alert alert-warning" role="alert">
        No sales data available for the selected day.
    </div>
}
<script>
    $(document).ready(function () {
        if (!$.fn.DataTable.isDataTable('#myDataTable_no_filter')) {
            $('#myDataTable_no_filter').DataTable({
                paging: false,
                searching: false,
                info: false,
                ordering: true,
                order: [],
                columnDefs: [
                    { orderable: false, targets: -1 }
                ]
            });
        }
    });
</script>