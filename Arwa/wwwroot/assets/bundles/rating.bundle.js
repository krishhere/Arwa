!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function($){t.prototype.init=function(t,e){return this.$elem=$(e),this.options=$.extend({},$.fn.barrating.defaults,t),this.options};var a=t;function t(){function e(){var t=(t=o.options.initialRating)?l(t):$("option:selected",o.$elem),e=!(e=o.$elem.find('option[value="'+o.options.emptyValue+'"]')).length&&o.options.allowEmpty?(e=$("<option />",{value:o.options.emptyValue})).prependTo(o.$elem):e,n=t.val(),t=t.data("html")?t.data("html"):t.text(),a=null!==o.options.allowEmpty?o.options.allowEmpty:!!e.length,i=e.length?e.val():null,e=e.length?e.text():null;u(null,{userOptions:o.options,ratingValue:n,ratingText:t,originalRatingValue:n,originalRatingText:t,allowEmpty:a,emptyRatingValue:i,emptyRatingText:e,readOnly:o.options.readonly,ratingMade:!1})}function i(t){return Math.round(Math.floor(10*t)/10%1*100)}function n(t){t.on("touchstart.barrating",function(t){t.preventDefault(),t.stopPropagation(),$(this).click()})}function a(t){t.off(".barrating")}function r(t){var e=o.$widget.find("a");n(e),t?(a(e),e.on("click.barrating",function(t){t.preventDefault()})):(b(t=e),o.options.hoverState&&(y(t),w(t)))}var o=this,l=function(t){return $.isNumeric(t)&&(t=Math.floor(t)),$('option[value="'+t+'"]',o.$elem)},s=function(t){var e=o.$elem.data("barrating");return void 0!==t?e[t]:e},u=function(t,e){null!==e&&"object"==typeof e?o.$elem.data("barrating",e):o.$elem.data("barrating")[t]=e},d=function(){return s("ratingText")},c=function(){return s("ratingValue")},g=function(){return s("userOptions").reverse?"nextAll":"prevAll"},p=function(t){l(t).prop("selected",!0),o.$elem.change()},f=function(t){(t=t||d())==s("emptyRatingText")&&(t=""),o.options.showSelectedRating&&o.$elem.parent().find(".br-current-rating").text(t)},h=function(){o.$widget.find("a").removeClass(function(t,e){return(e.match(/(^|\s)br-\S+/g)||[]).join(" ")})},m=function(){var t=o.$widget.find('a[data-rating-value="'+c()+'"]'),e=s("userOptions").initialRating,n=$.isNumeric(c())?c():0,a=i(e);h(),t.addClass("br-selected br-current")[g()]().addClass("br-selected"),s("ratingMade")||!$.isNumeric(e)||e<=n||!a||(e=o.$widget.find("a"),(n=t.length?t[s("userOptions").reverse?"prev":"next"]():e[s("userOptions").reverse?"last":"first"]()).addClass("br-fractional"),n.addClass("br-fractional-"+a))},v=function(t){return!(!s("allowEmpty")||!s("userOptions").deselectable)&&c()==t.attr("data-rating-value")},b=function(t){t.on("click.barrating",function(t){var e,n,a=$(this),i=s("userOptions");return t.preventDefault(),e=a.attr("data-rating-value"),n=a.attr("data-rating-text"),v(a)&&(e=s("emptyRatingValue"),n=s("emptyRatingText")),u("ratingValue",e),u("ratingText",n),u("ratingMade",!0),p(e),f(n),m(),i.onSelect.call(o,c(),d(),t),!1})},y=function(t){t.on("mouseenter.barrating",function(){var t=$(this);h(),t.addClass("br-active")[g()]().addClass("br-active"),f(t.attr("data-rating-text"))})},w=function(t){o.$widget.on("mouseleave.barrating blur.barrating",function(){f(),m()})};this.show=function(){var a,t;s()||(t=["br-wrapper"],""!==o.options.theme&&t.push("br-theme-"+o.options.theme),o.$elem.wrap($("<div />",{class:t.join(" ")})),e(),o.$widget=(a=$("<div />",{class:"br-widget"}),o.$elem.find("option").each(function(){var t,e,n=$(this).val();n!==s("emptyRatingValue")&&(t=$(this).text(),e=$(this).data("html"),n=$("<a />",{href:"#","data-rating-value":n,"data-rating-text":t=e?e:t,html:o.options.showValues?t:""}),a.append(n))}),o.options.showSelectedRating&&a.append($("<div />",{text:"",class:"br-current-rating"})),o.options.reverse&&a.addClass("br-reverse"),o.options.readonly&&a.addClass("br-readonly"),a),o.$widget.insertAfter(o.$elem),m(),f(),r(o.options.readonly),o.$elem.hide())},this.readonly=function(t){"boolean"==typeof t&&s("readOnly")!=t&&(r(t),u("readOnly",t),o.$widget.toggleClass("br-readonly"))},this.set=function(t){var e=s("userOptions");0!==o.$elem.find('option[value="'+t+'"]').length&&(u("ratingValue",t),u("ratingText",o.$elem.find('option[value="'+t+'"]').text()),u("ratingMade",!0),p(c()),f(d()),m(),e.silent||e.onSelect.call(this,c(),d()))},this.clear=function(){var t=s("userOptions");u("ratingValue",s("originalRatingValue")),u("ratingText",s("originalRatingText")),u("ratingMade",!1),$("option",o.$elem).prop("selected",function(){return this.defaultSelected}),o.$elem.change(),f(d()),m(),t.onClear.call(this,c(),d())},this.destroy=function(){var t=c(),e=d(),n=s("userOptions");a(o.$widget.find("a")),o.$widget.remove(),o.$elem.removeData("barrating"),o.$elem.unwrap(),o.$elem.show(),n.onDestroy.call(this,t,e)}}$.fn.barrating=function(e,n){return this.each(function(){var t=new a;return $(this).is("select")||$.error("Sorry, this plugin only works with select fields."),t.hasOwnProperty(e)?(t.init(n,this),"show"===e?t.show(n):t.$elem.data("barrating")?(t.$widget=$(this).next(".br-widget"),t[e](n)):void 0):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.barrating"):(n=e,t.init(n,this),t.show())})},$.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:!1,showSelectedRating:!0,deselectable:!0,reverse:!1,readonly:!1,fastClicks:!0,hoverState:!0,silent:!1,onSelect:function(t,e,n){},onClear:function(t,e){},onDestroy:function(t,e){}},$.fn.barrating.BarRating=a});